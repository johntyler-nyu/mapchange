/** uses voterfiles table loaded from DataPrep and adds the donor_id created in the donor table to join
the two datasets together **/

CREATE OR REPLACE TABLE `nyu-cap-ae.elt_ohio.voterfiles`
as
select *
,date_diff(CURRENT_DATE(),DATE_OF_BIRTH, YEAR) as age
,LEFT(FIRST_NAME,3)||LEFT(LAST_NAME,2)||RESIDENTIAL_ZIP||LEFT(RESIDENTIAL_CITY,3)||LEFT(RESIDENTIAL_ADDRESS1,2) as donor_id
from `nyu-cap-ae.junk.voterfiles_dataprep`;
